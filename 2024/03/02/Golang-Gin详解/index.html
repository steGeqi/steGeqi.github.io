<!DOCTYPE html><html lang="zh" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Golang-Gin详解 | 戈亓</title><meta name="keywords" content="Golang"><meta name="author" content="戈亓"><meta name="copyright" content="戈亓"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Golang-Gin详解"><meta name="application-name" content="Golang-Gin详解"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Golang-Gin详解"><meta property="og:url" content="https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/index.html"><meta property="og:site_name" content="戈亓"><meta property="og:description" content="一、快速入门go版本需求：go1.13及以上 环境：windows 11 123456789D:\go\project&amp;gt;mkdir ginlearnD:\go\project&amp;gt;cd ginlearnD:\go\project\ginlearn&amp;gt;go work initD:\go\p"><meta property="og:locale" content="zh"><meta property="og:image" content="https://geqi-blog.oss-cn-beijing.aliyuncs.com/article/202403021705142.png"><meta property="article:author" content="戈亓"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://geqi-blog.oss-cn-beijing.aliyuncs.com/article/202403021705142.png"><meta name="description" content="一、快速入门go版本需求：go1.13及以上 环境：windows 11 123456789D:\go\project&amp;gt;mkdir ginlearnD:\go\project&amp;gt;cd ginlearnD:\go\project\ginlearn&amp;gt;go work initD:\go\p"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 戈亓","link":"链接: ","source":"来源: 戈亓","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '戈亓',
  title: 'Golang-Gin详解',
  postAI: '',
  pageFillDescription: '一、快速入门, 二、路由, 1. RESTful API规范, 2. 请求方法, 3. URI, 4. 处理函数, 5. 分组路由, 三、请求参数, 1. Get请求参数, 1.1 普通参数, 1.2 数组参数, 1.3 map参数, 2. Post请求参数, 2.1 表单参数, 2.2 json参数, 3. 路径参数, 4. 文件参数, 四、响应, 1. 字符串方式, 2. JSON方式, 3. XML方式, 4. 文件格式, 5. 设置http响应头, 6. 重定向, 7. YAML方式, 五、模板渲染, 1. 基本使用, 2. 多个模板渲染, 3. 自定义模板函数, 4. 静态文件处理, 六、会话, 1. cookie, 1.1 设置cookie, 1.2 读取cookie, 1.3 删除cookie, 2. Session, 2.1 多session, 2.2 基于redis存储引擎的session, 七、中间件, 1. 中间件使用, 2. 自定义中间件一快速入门版本需求及以上环境下载并安装示例程序监听并在上启动服务运行后进行测试二路由路由是到函数的映射一个含协议比如等端口或者域名比如或者比如比如同时访问的时候还需要指明比如方法请求一个指定资源的表示形式使用的请求应该只被用于获取数据方法用于将实体提交到指定的资源通常会导致在服务器上的状态变化方法请求一个与请求的响应相同的响应但没有响应体方法用请求有效载荷替换目标资源的所有当前表示方法删除指定的资源方法建立一个到由目标资源标识的服务器的隧道方法用于描述目标资源的通信选项方法沿着到目标资源的路径执行一个消息环回测试方法用于对资源应用部分修改使用的时候应该尽量遵循其语义规范的规范建议我们使用特定的方法来对服务器上的资源进行操作比如表示读取服务器上的资源表示在服务器上创建资源表示更新或者替换服务器上的资源表示删除服务器上的资源表示更新修改资源的一部分请求方法比如如果想要支持所有如果想要支持其中的几种数组结构体数组结构体书写的时候我们不需要关心和这两部分我们主要通过和两部分的书写来进行资源的定位静态比如路径参数比如模糊匹配比如处理函数定义通过上下文的参数获取的请求参数响应请求等分组路由在进行开发的时候我们往往要进行模块的划分比如用户模块以开发商品模块以开头或者进行多版本开发不同版本之间路径是一致的这种时候就可以用到分组路由了比如三请求参数请求参数使用请求传参时类似于这样如何获取呢普通参数如果参数不存在就给一个默认值北京判断参数是否存在是数值类型上述获取的都是类型根据类型获取也可以区别当是必须的时候会报错开发者自行处理状态码不变则报错的同时会将状态码改为所以一般建议是使用开头的数组参数请求参数请求参数并没有支持请求参数请求一般是表单参数和参数表单参数参数其他类型参数注入等和道理一样路径参数请求文件参数四响应字符串方式方式方式文件格式设置响应头重定向方式五模板渲染模板是语言的一个标准库使用场景很多框架同样支持模板由于现在开发大部分为亲啊后端分离开发因此几乎不再使用模板基本使用定义一个存放模板文件的文件夹后端代码模板解析请求模板的渲染模板启动多个模板渲染如果有多个模板可以统一进行渲染模板解析解析目录下的所有模板文件如果目录为和这种可以代表所有子目录下的所有文件自定义模板函数框架给模板添加自定义函数模板解析解析目录下的所有模板文件请求模板的渲染跳转到其他地方静态文件处理如果在模板中引入静态文件比如样式文件加载静态文件六会话会话控制涉及到和的使用是无状态协议服务器不能记录浏览器的访问状态也就是说服务器不能区分两次请求是否由同一个客户端发出就是解决协议无状态的方案之一实际上就是服务器保存在浏览器上的一段信息浏览器有了之后每次向服务器发送请求时都会同时将该信息发送给服务器服务器收到请求后就可以根据该信息处理请求由服务器创建并发送给浏览器最终由浏览器保存设置参数说明参数名类型说明名字值有效时间单位是秒忽略属性相当于删除通常可以设置代表删除多少秒后失效路径作用域那么这个只能用协议发送给服务器设置的不能被获取到设置读取根据名字读取值直接返回值删除通过将的设置为达到删除的目的设置设置为表示删除删除在框架中我们可以依赖中间件处理安装包创建基于的存储引擎参数是用于加密的密钥设置中间件参数指的是的名字也是的名字是前面创建的存储引擎我们可以替换成其他存储引擎初始化对象通过读取值是键值对格式数据因此需要通过查询数据没读到设置数据多基于存储引擎的如果我们想将数据保存到中只要将的存储引擎改成即可使用作为存储引擎的例子首先安装存储引擎的包初始化基于的存储引擎参数说明第个参数最大的空闲连接数第个参数数通信协议或者第个参数地址格式第个参数密码第个参数加密密钥七中间件在框架中中间件指的是可以拦截请求响应生命周期的特殊函数在请求响应生命周期中可以注册多个中间件每个中间件执行不同的功能一个中间执行完再轮到下一个中间件执行中间件的常见应用场景如下请求限速接口签名处理权限校验统一错误处理支持设置全局中间件和针对路由分组设置中间件设置全局中间件意思就是会拦截所有请求针对分组路由设置中间件意思就是仅对这个分组下的路由起作用中间件使用通过设置全局中间件设置日志中间件主要用于打印请求日志设置中间件主要用于拦截错误不至于导致进程崩掉自定义中间件使用可以使用自带的中间件或者其他第三方中间件也可以自己开发中间件导入包自定义个日志中间件可以通过上下文对象设置一些依附在上下文对象里面的键值数据在这里处理请求到达控制器函数之前的逻辑调用下一个中间件或者控制器处理函数具体得看注册了多少个中间件在这里可以处理请求返回给用户之前的逻辑例如查询请求状态吗注册上面自定义的日志中间件查询我们之前在日志中间件注入的键值数据',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-06 19:45:00',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/album/202308262203639.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://steGeqi.github.io" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">戈亓</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 一些时刻</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 1.05rem;">Docker<sup>2</sup></a><a href="/tags/Golang/" style="font-size: 1.05rem;">Golang<sup>7</sup></a><a href="/tags/Gorm/" style="font-size: 1.05rem;">Gorm<sup>4</sup></a><a href="/tags/Leetcode/" style="font-size: 1.05rem;">Leetcode<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>2</sup></a><a href="/tags/Nginx/" style="font-size: 1.05rem;">Nginx<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/" style="font-size: 1.05rem;">代码随想录<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>3</sup></a><a href="/tags/%E5%A4%A7%E5%AD%A6/" style="font-size: 1.05rem;">大学<sup>1</sup></a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">小程序教程<sup>1</sup></a><a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">年终总结<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">开发<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 1.05rem;">微信小程序<sup>1</sup></a><a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 1.05rem;">感悟<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/" style="font-size: 1.05rem;">生物信息学<sup>14</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 1.05rem;">计算机组成原理<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">计算机网络<sup>6</sup></a><a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 1.05rem;">运维<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">March 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">February 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">January 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">December 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">November 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">October 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">September 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">August 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Golang/" itemprop="url">Golang</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Golang/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Golang</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Golang-Gin详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-03-02T13:08:19.000Z" title="发表于 2024-03-02 21:08:19">2024-03-02</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-03-06T11:45:00.548Z" title="更新于 2024-03-06 19:45:00">2024-03-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/"><header><a class="post-meta-categories" href="/categories/Golang/" itemprop="url">Golang</a><a href="/tags/Golang/" tabindex="-1" itemprop="url">Golang</a><h1 id="CrawlerTitle" itemprop="name headline">Golang-Gin详解</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">戈亓</span><time itemprop="dateCreated datePublished" datetime="2024-03-02T13:08:19.000Z" title="发表于 2024-03-02 21:08:19">2024-03-02</time><time itemprop="dateCreated datePublished" datetime="2024-03-06T11:45:00.548Z" title="更新于 2024-03-06 19:45:00">2024-03-06</time></header><h1 id="一、快速入门"><a href="#一、快速入门" class="headerlink" title="一、快速入门"></a>一、快速入门</h1><p>go版本需求：go1.13及以上</p>
<p>环境：windows 11</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">D:\<span class="title">go</span>\<span class="title">project</span>&gt;<span class="title">mkdir</span> <span class="title">ginlearn</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>&gt;<span class="title">cd</span> <span class="title">ginlearn</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>&gt;<span class="title">go</span> <span class="title">work</span> <span class="title">init</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>&gt;<span class="title">mkdir</span> <span class="title">helloworld</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>&gt;<span class="title">cd</span> <span class="title">helloworld</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>\<span class="title">helloworld</span>&gt;<span class="title">go</span> <span class="title">mod</span> <span class="title">init</span> <span class="title">test.com</span>/<span class="title">helloworld</span></span></span><br><span class="line"><span class="function"><span class="title">go</span>: <span class="title">creating</span> <span class="title">new</span> <span class="title">go.mod</span>: <span class="title">module</span> <span class="title">test.com</span>/<span class="title">helloworld</span></span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>\<span class="title">helloworld</span>&gt;<span class="title">cd</span> ..</span></span><br><span class="line"><span class="function"><span class="title">D</span>:\<span class="title">go</span>\<span class="title">project</span>\<span class="title">ginlearn</span>&gt;<span class="title">go</span> <span class="title">work</span> <span class="title">use</span> ./<span class="title">helloworld</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\go\project\ginlearn&gt; cd .\helloworld\</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">下载并安装gin</span></span><br><span class="line">PS D:\go\project\ginlearn\helloworld&gt; go get -u github.com/gin-gonic/gin</span><br></pre></td></tr></table></figure>

<p>示例程序：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;pong&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run() <span class="comment">// 监听并在 0.0.0.0:8080 上启动服务</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行后，postman进行测试</p>
<p><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403061941370.png"></p>
<h1 id="二、路由"><a href="#二、路由" class="headerlink" title="二、路由"></a>二、路由</h1><p>路由是URI到函数的映射。</p>
<p>一个URI含:  <code>http://localhost:8080/user/find?id=11</code></p>
<ul>
<li>协议，比如http，https等</li>
<li>ip端口或者域名，比如127.0.0.1:8080或者<code>www.test.com</code></li>
<li>path，比如 &#x2F;path</li>
<li>query，比如 ?query</li>
</ul>
<p>同时访问的时候，还需要指明HTTP METHOD，比如</p>
<ul>
<li><p>GET</p>
<p>GET方法请求一个指定资源的表示形式. 使用GET的请求应该只被用于获取数据.</p>
</li>
<li><p>POST</p>
<p>POST方法用于将实体提交到指定的资源，通常会导致在服务器上的状态变化</p>
</li>
<li><p>HEAD</p>
<p>HEAD方法请求一个与GET请求的响应相同的响应，但没有响应体.</p>
</li>
<li><p>PUT</p>
<p>PUT方法用请求有效载荷替换目标资源的所有当前表示</p>
</li>
<li><p>DELETE</p>
<p>DELETE方法删除指定的资源</p>
</li>
<li><p>CONNECT</p>
<p>CONNECT方法建立一个到由目标资源标识的服务器的隧道。</p>
</li>
<li><p>OPTIONS</p>
<p>OPTIONS方法用于描述目标资源的通信选项。</p>
</li>
<li><p>TRACE</p>
<p>TRACE方法沿着到目标资源的路径执行一个消息环回测试。</p>
</li>
<li><p>PATCH</p>
<p>PATCH方法用于对资源应用部分修改。</p>
</li>
</ul>
<blockquote>
<p>使用的时候，应该尽量遵循其语义</p>
</blockquote>
<h2 id="1-RESTful-API规范"><a href="#1-RESTful-API规范" class="headerlink" title="1. RESTful API规范"></a>1. RESTful API规范</h2><p>RESTful API 的规范建议我们使用特定的HTTP方法来对服务器上的资源进行操作。</p>
<p>比如：</p>
<ol>
<li>GET，表示读取服务器上的资源</li>
<li>POST，表示在服务器上创建资源</li>
<li>PUT,表示更新或者替换服务器上的资源</li>
<li>DELETE，表示删除服务器上的资源</li>
<li>PATCH，表示更新&#x2F;修改资源的一部分</li>
</ol>
<h2 id="2-请求方法"><a href="#2-请求方法" class="headerlink" title="2. 请求方法"></a>2. 请求方法</h2><p>比如</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/get&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	ctx.JSON(<span class="number">200</span>, <span class="string">&quot;get&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">r.POST(<span class="string">&quot;/post&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	ctx.JSON(<span class="number">200</span>, <span class="string">&quot;post&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">r.DELETE(<span class="string">&quot;/delete&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	ctx.JSON(<span class="number">200</span>, <span class="string">&quot;delete&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">r.PUT(<span class="string">&quot;/put&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	ctx.JSON(<span class="number">200</span>, <span class="string">&quot;put&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>如果想要支持所有：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.Any(<span class="string">&quot;/any&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, <span class="string">&quot;any&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>如果想要支持其中的几种：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  r.GET(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="comment">//数组 map list 结构体</span></span><br><span class="line">	ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">		<span class="string">&quot;name&quot;</span>: <span class="string">&quot;hello world&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">r.POST(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="comment">//数组 map list 结构体</span></span><br><span class="line">	ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">		<span class="string">&quot;name&quot;</span>: <span class="string">&quot;hello world&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3-URI"><a href="#3-URI" class="headerlink" title="3. URI"></a>3. URI</h2><p>URI书写的时候，我们不需要关心scheme和authority这两部分，我们主要通过path和query两部分的书写来进行资源的定位。</p>
<ul>
<li><p>静态url，比如<code>/hello</code>，<code>/user/find</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/find&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


</li>
<li><p>路径参数，比如<code>/user/find/:id</code> </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/find/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		param := ctx.Param(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, param)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊匹配，比如<code>/user/*path</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/*path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		param := ctx.Param(<span class="string">&quot;path&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, param)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="4-处理函数"><a href="#4-处理函数" class="headerlink" title="4. 处理函数"></a>4. 处理函数</h2><p>定义：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> HandlerFunc <span class="function"><span class="keyword">func</span><span class="params">(*Context)</span></span></span><br></pre></td></tr></table></figure>

<p>通过上下文的参数，获取http的请求参数，响应http请求等。</p>
<h2 id="5-分组路由"><a href="#5-分组路由" class="headerlink" title="5. 分组路由"></a>5. 分组路由</h2><p>在进行开发的时候，我们往往要进行模块的划分，比如用户模块，以user开发，商品模块，以goods开头。</p>
<p>或者进行多版本开发，不同版本之间路径是一致的，这种时候，就可以用到分组路由了。</p>
<p>比如</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  ug := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">	ug.GET(<span class="string">&quot;find&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, <span class="string">&quot;user find&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	ug.POST(<span class="string">&quot;save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, <span class="string">&quot;user save&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line">gg := r.Group(<span class="string">&quot;/goods&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">	gg.GET(<span class="string">&quot;find&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, <span class="string">&quot;goods find&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	gg.POST(<span class="string">&quot;save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, <span class="string">&quot;goods save&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="三、请求参数"><a href="#三、请求参数" class="headerlink" title="三、请求参数"></a>三、请求参数</h1><h2 id="1-Get请求参数"><a href="#1-Get请求参数" class="headerlink" title="1. Get请求参数"></a>1. Get请求参数</h2><p>使用Get请求传参时，类似于这样 <code>http://localhost:8080/user/save?id=11&amp;name=zhangsan</code>。</p>
<p>如何获取呢？</p>
<h3 id="1-1-普通参数"><a href="#1-1-普通参数" class="headerlink" title="1.1 普通参数"></a>1.1 普通参数</h3><p>request url: <code>http://localhost:8080/user/save?id=11&amp;name=zhangsan</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		id := ctx.Query(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		name := ctx.Query(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;id&quot;</span>:   id,</span><br><span class="line">			<span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>如果参数不存在，就给一个默认值：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		id := ctx.Query(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		name := ctx.Query(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		address := ctx.DefaultQuery(<span class="string">&quot;address&quot;</span>, <span class="string">&quot;北京&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;id&quot;</span>:      id,</span><br><span class="line">			<span class="string">&quot;name&quot;</span>:    name,</span><br><span class="line">			<span class="string">&quot;address&quot;</span>: address,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>判断参数是否存在：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		id, ok := ctx.GetQuery(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		address, aok := ctx.GetQuery(<span class="string">&quot;address&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;id&quot;</span>:      id,</span><br><span class="line">			<span class="string">&quot;idok&quot;</span>:    ok,</span><br><span class="line">			<span class="string">&quot;address&quot;</span>: address,</span><br><span class="line">			<span class="string">&quot;aok&quot;</span>:     aok,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>id是数值类型，上述获取的都是string类型，根据类型获取：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id   <span class="type">int64</span>  <span class="string">`form:&quot;id&quot;`</span></span><br><span class="line">	Name <span class="type">string</span> <span class="string">`form:&quot;name&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> user User</span><br><span class="line">		err := ctx.BindQuery(&amp;user)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, user)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>也可以：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> user User</span><br><span class="line">		err := ctx.ShouldBindQuery(&amp;user)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, user)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>区别：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id      <span class="type">int64</span>  <span class="string">`form:&quot;id&quot;`</span></span><br><span class="line">	Name    <span class="type">string</span> <span class="string">`form:&quot;name&quot;`</span></span><br><span class="line">	Address <span class="type">string</span> <span class="string">`form:&quot;address&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当bind是必须的时候，ShouldBindQuery会报错，开发者自行处理，状态码不变。</p>
<p>BindQuery则报错的同时，会将状态码改为400。所以一般建议是使用Should开头的bind。</p>
<h3 id="1-2-数组参数"><a href="#1-2-数组参数" class="headerlink" title="1.2 数组参数"></a>1.2 数组参数</h3><p>请求url：<code>http://localhost:8080/user/save?address=Beijing&amp;address=shanghai</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		address := ctx.QueryArray(<span class="string">&quot;address&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, address)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		address, ok := ctx.GetQueryArray(<span class="string">&quot;address&quot;</span>)</span><br><span class="line">		fmt.Println(ok)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, address)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> user User</span><br><span class="line">		err := ctx.ShouldBindQuery(&amp;user)</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, user)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="1-3-map参数"><a href="#1-3-map参数" class="headerlink" title="1.3 map参数"></a>1.3 map参数</h3><p>请求url：<code>http://localhost:8080/user/save?addressMap[home]=Beijing&amp;addressMap[company]=shanghai</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		addressMap := ctx.QueryMap(<span class="string">&quot;addressMap&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, addressMap)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		addressMap, _ := ctx.GetQueryMap(<span class="string">&quot;addressMap&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, addressMap)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>map参数 bind并没有支持</p>
<h2 id="2-Post请求参数"><a href="#2-Post请求参数" class="headerlink" title="2. Post请求参数"></a>2. Post请求参数</h2><p>post请求一般是表单参数和json参数</p>
<h3 id="2-1-表单参数"><a href="#2-1-表单参数" class="headerlink" title="2.1 表单参数"></a>2.1 表单参数</h3><p><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403061942486.png"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		id := ctx.PostForm(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		name := ctx.PostForm(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		address := ctx.PostFormArray(<span class="string">&quot;address&quot;</span>)</span><br><span class="line">		addressMap := ctx.PostFormMap(<span class="string">&quot;addressMap&quot;</span>)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;id&quot;</span>:         id,</span><br><span class="line">			<span class="string">&quot;name&quot;</span>:       name,</span><br><span class="line">			<span class="string">&quot;address&quot;</span>:    address,</span><br><span class="line">			<span class="string">&quot;addressMap&quot;</span>: addressMap,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> user User</span><br><span class="line">		err := ctx.ShouldBind(&amp;user)</span><br><span class="line">		addressMap, _ := ctx.GetPostFormMap(<span class="string">&quot;addressMap&quot;</span>)</span><br><span class="line">		user.AddressMap = addressMap</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, user)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="2-2-json参数"><a href="#2-2-json参数" class="headerlink" title="2.2 json参数"></a>2.2 json参数</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="number">1111</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;zhangsan&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;beijing&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;shanghai&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;addressMap&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;home&quot;</span><span class="punctuation">:</span><span class="string">&quot;beijing&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> user User</span><br><span class="line">		err := ctx.ShouldBindJSON(&amp;user)</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, user)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<p>其他类型参数注入xml，yaml等和json道理一样</p>
<h2 id="3-路径参数"><a href="#3-路径参数" class="headerlink" title="3. 路径参数"></a>3. 路径参数</h2><p>请求url：<code>http://localhost:8080/user/save/111</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/save/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, ctx.Param(<span class="string">&quot;id&quot;</span>))</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="4-文件参数"><a href="#4-文件参数" class="headerlink" title="4. 文件参数"></a>4. 文件参数</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		form, err := ctx.MultipartForm()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			log.Println(err)</span><br><span class="line">		&#125;</span><br><span class="line">		files := form.File</span><br><span class="line">		<span class="keyword">for</span> _, fileArray := <span class="keyword">range</span> files &#123;</span><br><span class="line">			<span class="keyword">for</span> _, v := <span class="keyword">range</span> fileArray &#123;</span><br><span class="line">				ctx.SaveUploadedFile(v, <span class="string">&quot;./&quot;</span>+v.Filename)</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		ctx.JSON(<span class="number">200</span>, form.Value)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="四、响应"><a href="#四、响应" class="headerlink" title="四、响应"></a>四、响应</h1><h2 id="1-字符串方式"><a href="#1-字符串方式" class="headerlink" title="1. 字符串方式"></a>1. 字符串方式</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.String(http.StatusOK, <span class="string">&quot;this is a %s&quot;</span>, <span class="string">&quot;ms string response&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>



<h2 id="2-JSON方式"><a href="#2-JSON方式" class="headerlink" title="2. JSON方式"></a>2. JSON方式</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3-XML方式"><a href="#3-XML方式" class="headerlink" title="3. XML方式"></a>3. XML方式</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> XmlUser <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id   <span class="type">int64</span>  <span class="string">`xml:&quot;id&quot;`</span></span><br><span class="line">	Name <span class="type">string</span> <span class="string">`xml:&quot;name&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		u := XmlUser&#123;</span><br><span class="line">			Id:   <span class="number">11</span>,</span><br><span class="line">			Name: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		ctx.XML(http.StatusOK, u)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="4-文件格式"><a href="#4-文件格式" class="headerlink" title="4. 文件格式"></a>4. 文件格式</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">//ctx.File(&quot;./1.png&quot;)</span></span><br><span class="line">		ctx.FileAttachment(<span class="string">&quot;./1.png&quot;</span>, <span class="string">&quot;2.png&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="5-设置http响应头"><a href="#5-设置http响应头" class="headerlink" title="5. 设置http响应头"></a>5. 设置http响应头</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.Header(<span class="string">&quot;test&quot;</span>, <span class="string">&quot;headertest&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="6-重定向"><a href="#6-重定向" class="headerlink" title="6. 重定向"></a>6. 重定向</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.Redirect(http.StatusMovedPermanently, <span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="7-YAML方式"><a href="#7-YAML方式" class="headerlink" title="7. YAML方式"></a>7. YAML方式</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/user/save&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">		ctx.YAML(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;ms&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">19</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="五、模板渲染"><a href="#五、模板渲染" class="headerlink" title="五、模板渲染"></a>五、模板渲染</h1><p>模板是golang语言的一个标准库，使用场景很多，gin框架同样支持模板。由于现在开发大部分为亲啊后端分离开发，因此几乎不再使用模板。</p>
<h2 id="1-基本使用"><a href="#1-基本使用" class="headerlink" title="1. 基本使用"></a>1. 基本使用</h2><p>定义一个存放模板文件的<code>templates</code>文件夹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>gin_templates<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">&#123;&#123;.title&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>后端代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">// 模板解析</span></span><br><span class="line">	r.LoadHTMLFiles(<span class="string">&quot;templates/index.tmpl&quot;</span>)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// HTML请求</span></span><br><span class="line">		<span class="comment">// 模板的渲染</span></span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;hello 模板&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.Run(<span class="string">&quot;:9090&quot;</span>) <span class="comment">// 启动server</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2-多个模板渲染"><a href="#2-多个模板渲染" class="headerlink" title="2. 多个模板渲染"></a>2. 多个模板渲染</h2><p>如果有多个模板，可以统一进行渲染</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模板解析,解析templates目录下的所有模板文件</span></span><br><span class="line">	r.LoadHTMLGlob(<span class="string">&quot;templates/**&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>如果目录为<code>templates/post/index.tmpl</code>和<code>templates/user/index.tmpl</code>这种，可以</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// **/* 代表所有子目录下的所有文件</span></span><br><span class="line">router.LoadHTMLGlob(<span class="string">&quot;templates/**/*&quot;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="3-自定义模板函数"><a href="#3-自定义模板函数" class="headerlink" title="3. 自定义模板函数"></a>3. 自定义模板函数</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// gin框架给模板添加自定义函数</span></span><br><span class="line">r.SetFuncMap(template.FuncMap&#123;</span><br><span class="line">	<span class="string">&quot;safe&quot;</span>: <span class="function"><span class="keyword">func</span><span class="params">(str <span class="type">string</span>)</span></span> template.HTML &#123;</span><br><span class="line">		<span class="keyword">return</span> template.HTML(str)</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 模板解析,解析templates目录下的所有模板文件</span></span><br><span class="line">r.LoadHTMLGlob(<span class="string">&quot;templates/**&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="comment">// HTML请求</span></span><br><span class="line">	<span class="comment">// 模板的渲染</span></span><br><span class="line">	c.HTML(http.StatusOK, <span class="string">&quot;index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">		<span class="string">&quot;title&quot;</span>: <span class="string">&quot;&lt;a href=&#x27;http://baidu.com&#x27;&gt;跳转到其他地方&lt;/a&gt;&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;gin_templates&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&#123;&#123;.title | safe&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-静态文件处理"><a href="#4-静态文件处理" class="headerlink" title="4. 静态文件处理"></a>4. 静态文件处理</h2><p>如果在模板中引入静态文件，比如样式文件</p>
<p>index.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: aqua;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;gin_templates&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;/css/index.css&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&#123;&#123;.title&#125;&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载静态文件</span></span><br><span class="line">r.Static(<span class="string">&quot;/css&quot;</span>, <span class="string">&quot;./static/css&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="六、会话"><a href="#六、会话" class="headerlink" title="六、会话"></a>六、会话</h1><p>会话控制涉及到cookie和session的使用</p>
<h2 id="1-cookie"><a href="#1-cookie" class="headerlink" title="1. cookie"></a>1. cookie</h2><ol>
<li>HTTP是无状态协议，服务器不能记录浏览器的访问状态，也就是说服务器不能区分两次请求是否由同一个客户端发出</li>
<li>Cookie就是解决HTTP协议无状态的方案之一</li>
<li>Cookie实际上就是服务器保存在浏览器上的一段信息。浏览器有了Cookie之后，每次向服务器发送请求时都会同时将该信息发送给服务器，服务器收到请求后，就可以根据该信息处理请求</li>
<li>Cookie由服务器创建，并发送给浏览器，最终由浏览器保存</li>
</ol>
<h3 id="1-1-设置cookie"><a href="#1-1-设置cookie" class="headerlink" title="1.1 设置cookie"></a>1.1 设置cookie</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Context)</span></span> SetCookie(name, value <span class="type">string</span>, maxAge <span class="type">int</span>, path, domain <span class="type">string</span>, secure, httpOnly <span class="type">bool</span>)</span><br></pre></td></tr></table></figure>

<p>参数说明：</p>
<table>
<thead>
<tr>
<th>参数名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>string</td>
<td>cookie名字</td>
</tr>
<tr>
<td>value</td>
<td>string</td>
<td>cookie值</td>
</tr>
<tr>
<td>maxAge</td>
<td>int</td>
<td>有效时间，单位是秒，MaxAge&#x3D;0 忽略MaxAge属性，MaxAge&lt;0 相当于删除cookie, 通常可以设置-1代表删除，MaxAge&gt;0 多少秒后cookie失效</td>
</tr>
<tr>
<td>path</td>
<td>string</td>
<td>cookie路径</td>
</tr>
<tr>
<td>domain</td>
<td>string</td>
<td>cookie作用域</td>
</tr>
<tr>
<td>secure</td>
<td>bool</td>
<td>Secure&#x3D;true，那么这个cookie只能用https协议发送给服务器</td>
</tr>
<tr>
<td>httpOnly</td>
<td>bool</td>
<td>设置HttpOnly&#x3D;true的cookie不能被js获取到</td>
</tr>
</tbody></table>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/cookie&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 设置cookie</span></span><br><span class="line">		c.SetCookie(<span class="string">&quot;site_cookie&quot;</span>, <span class="string">&quot;cookievalue&quot;</span>, <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;localhost&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="1-2-读取cookie"><a href="#1-2-读取cookie" class="headerlink" title="1.2 读取cookie"></a>1.2 读取cookie</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/read&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 根据cookie名字读取cookie值</span></span><br><span class="line">		data, err := c.Cookie(<span class="string">&quot;site_cookie&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="comment">// 直接返回cookie值</span></span><br><span class="line">			c.String(<span class="number">200</span>,data)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		c.String(<span class="number">200</span>,<span class="string">&quot;not found!&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="1-3-删除cookie"><a href="#1-3-删除cookie" class="headerlink" title="1.3 删除cookie"></a>1.3 删除cookie</h3><p>通过将cookie的MaxAge设置为-1, 达到删除cookie的目的。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/del&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 设置cookie  MaxAge设置为-1，表示删除cookie</span></span><br><span class="line">		c.SetCookie(<span class="string">&quot;site_cookie&quot;</span>, <span class="string">&quot;cookievalue&quot;</span>, <span class="number">-1</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;localhost&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">		c.String(<span class="number">200</span>,<span class="string">&quot;删除cookie&quot;</span>)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="2-Session"><a href="#2-Session" class="headerlink" title="2. Session"></a>2. Session</h2><p>在Gin框架中，我们可以依赖<a target="_blank" rel="noopener" href="https://github.com/gin-contrib/sessions">gin-contrib&#x2F;sessions</a>中间件处理session。</p>
<p>安装session包</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> get github.com/gin-contrib/sessions</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions/cookie&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">// 创建基于cookie的存储引擎，secret 参数是用于加密的密钥</span></span><br><span class="line">	store := cookie.NewStore([]<span class="type">byte</span>(<span class="string">&quot;secret&quot;</span>))</span><br><span class="line">	<span class="comment">// 设置session中间件，参数mysession，指的是session的名字，也是cookie的名字</span></span><br><span class="line">	<span class="comment">// store是前面创建的存储引擎，我们可以替换成其他存储引擎</span></span><br><span class="line">	r.Use(sessions.Sessions(<span class="string">&quot;mysession&quot;</span>, store))</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 初始化session对象</span></span><br><span class="line">		session := sessions.Default(c)</span><br><span class="line">		<span class="comment">// 通过session.Get读取session值</span></span><br><span class="line">		<span class="comment">// session是键值对格式数据，因此需要通过key查询数据</span></span><br><span class="line">		<span class="keyword">if</span> session.Get(<span class="string">&quot;hello&quot;</span>) != <span class="string">&quot;world&quot;</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">&quot;没读到&quot;</span>)</span><br><span class="line">			<span class="comment">// 设置session数据</span></span><br><span class="line">			session.Set(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world&quot;</span>)</span><br><span class="line">			session.Save()</span><br><span class="line">		&#125;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;hello&quot;</span>: session.Get(<span class="string">&quot;hello&quot;</span>)&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-1-多session"><a href="#2-1-多session" class="headerlink" title="2.1 多session"></a>2.1 多session</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions/cookie&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	store := cookie.NewStore([]<span class="type">byte</span>(<span class="string">&quot;secret&quot;</span>))</span><br><span class="line">	sessionNames := []<span class="type">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>&#125;</span><br><span class="line">	r.Use(sessions.SessionsMany(sessionNames, store))</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		sessionA := sessions.DefaultMany(c, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">		sessionB := sessions.DefaultMany(c, <span class="string">&quot;b&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> sessionA.Get(<span class="string">&quot;hello&quot;</span>) != <span class="string">&quot;world!&quot;</span> &#123;</span><br><span class="line">			sessionA.Set(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world!&quot;</span>)</span><br><span class="line">			sessionA.Save()</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> sessionB.Get(<span class="string">&quot;hello&quot;</span>) != <span class="string">&quot;world?&quot;</span> &#123;</span><br><span class="line">			sessionB.Set(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;world?&quot;</span>)</span><br><span class="line">			sessionB.Save()</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;a&quot;</span>: sessionA.Get(<span class="string">&quot;hello&quot;</span>),</span><br><span class="line">			<span class="string">&quot;b&quot;</span>: sessionB.Get(<span class="string">&quot;hello&quot;</span>),</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-2-基于redis存储引擎的session"><a href="#2-2-基于redis存储引擎的session" class="headerlink" title="2.2 基于redis存储引擎的session"></a>2.2 基于redis存储引擎的session</h3><p>如果我们想将session数据保存到redis中，只要将session的存储引擎改成redis即可。</p>
<p>使用redis作为存储引擎的例子：</p>
<p>首先安装redis存储引擎的包</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> get github.com/gin-contrib/sessions/redis</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/sessions/redis&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	<span class="comment">// 初始化基于redis的存储引擎</span></span><br><span class="line">	<span class="comment">// 参数说明：</span></span><br><span class="line">	<span class="comment">//    第1个参数 - redis最大的空闲连接数</span></span><br><span class="line">	<span class="comment">//    第2个参数 - 数通信协议tcp或者udp</span></span><br><span class="line">	<span class="comment">//    第3个参数 - redis地址, 格式，host:port</span></span><br><span class="line">	<span class="comment">//    第4个参数 - redis密码</span></span><br><span class="line">	<span class="comment">//    第5个参数 - session加密密钥</span></span><br><span class="line">	store, _ := redis.NewStore(<span class="number">10</span>, <span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;localhost:6379&quot;</span>, <span class="string">&quot;&quot;</span>, []<span class="type">byte</span>(<span class="string">&quot;secret&quot;</span>))</span><br><span class="line">	r.Use(sessions.Sessions(<span class="string">&quot;mysession&quot;</span>, store))</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/incr&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		session := sessions.Default(c)</span><br><span class="line">		<span class="keyword">var</span> count <span class="type">int</span></span><br><span class="line">		v := session.Get(<span class="string">&quot;count&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> v == <span class="literal">nil</span> &#123;</span><br><span class="line">			count = <span class="number">0</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			count = v.(<span class="type">int</span>)</span><br><span class="line">			count++</span><br><span class="line">		&#125;</span><br><span class="line">		session.Set(<span class="string">&quot;count&quot;</span>, count)</span><br><span class="line">		session.Save()</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;count&quot;</span>: count&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="七、中间件"><a href="#七、中间件" class="headerlink" title="七、中间件"></a>七、中间件</h1><p>在Gin框架中，<strong>中间件</strong>（Middleware）指的是可以拦截<strong>http请求-响应</strong>生命周期的特殊函数，在请求-响应生命周期中可以注册多个中间件，每个中间件执行不同的功能，一个中间执行完再轮到下一个中间件执行。</p>
<p><strong>中间件的常见应用场景如下：</strong></p>
<ul>
<li>请求限速</li>
<li>api接口签名处理</li>
<li>权限校验</li>
<li>统一错误处理</li>
</ul>
<p>Gin支持设置全局中间件和针对路由分组设置中间件，设置全局中间件意思就是会拦截所有请求，针对分组路由设置中间件，意思就是仅对这个分组下的路由起作用。</p>
<h2 id="1-中间件使用"><a href="#1-中间件使用" class="headerlink" title="1. 中间件使用"></a>1. 中间件使用</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  r := gin.New()</span><br><span class="line"><span class="comment">// 通过use设置全局中间件</span></span><br><span class="line"><span class="comment">// 设置日志中间件，主要用于打印请求日志</span></span><br><span class="line">r.Use(gin.Logger())</span><br><span class="line"><span class="comment">// 设置Recovery中间件，主要用于拦截paic错误，不至于导致进程崩掉</span></span><br><span class="line">r.Use(gin.Recovery())</span><br><span class="line">r.GET(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(ctx *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(errors.New(<span class="string">&quot;test error&quot;</span>))</span><br><span class="line">&#125;)</span><br><span class="line">r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="2-自定义中间件"><a href="#2-自定义中间件" class="headerlink" title="2. 自定义中间件"></a>2. 自定义中间件</h2><p>使用Use可以使用gin自带的中间件或者其他第三方中间件，也可以自己开发中间件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="comment">// 导入gin包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义个日志中间件</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Logger</span><span class="params">()</span></span> gin.HandlerFunc &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		t := time.Now()</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 可以通过上下文对象，设置一些依附在上下文对象里面的键/值数据</span></span><br><span class="line">		c.Set(<span class="string">&quot;example&quot;</span>, <span class="string">&quot;12345&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 在这里处理请求到达控制器函数之前的逻辑</span></span><br><span class="line">     </span><br><span class="line">		<span class="comment">// 调用下一个中间件，或者控制器处理函数，具体得看注册了多少个中间件。</span></span><br><span class="line">		c.Next()</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 在这里可以处理请求返回给用户之前的逻辑</span></span><br><span class="line">		latency := time.Since(t)</span><br><span class="line">		log.Print(latency)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 例如，查询请求状态吗</span></span><br><span class="line">		status := c.Writer.Status()</span><br><span class="line">		log.Println(status)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.New()</span><br><span class="line">	<span class="comment">// 注册上面自定义的日志中间件</span></span><br><span class="line">	r.Use(Logger())</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 查询我们之前在日志中间件，注入的键值数据</span></span><br><span class="line">		example := c.MustGet(<span class="string">&quot;example&quot;</span>).(<span class="type">string</span>)</span><br><span class="line">		<span class="comment">// it would print: &quot;12345&quot;</span></span><br><span class="line">		log.Println(example)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Listen and serve on 0.0.0.0:8080</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/album/202308262203639.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/album/202308262203639.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">戈亓</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/')">Golang-Gin详解</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=https://stegeqi.github.io/2024/03/02/Golang-Gin%E8%AF%A6%E8%A7%A3/&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://stegeqi.github.io" target="_blank">戈亓</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Golang/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Golang<span class="tagsPageCount">7</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://geqi-blog.oss-cn-beijing.aliyuncs.com/docker/202403060010535.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/03/02/Golang-%E6%A0%87%E5%87%86%E5%BA%93/"><img class="prev-cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/article/202403021705142.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Golang-标准库</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/06/Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"><img class="next-cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/docker/202403060010535.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Docker常用命令</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/03/02/Golang-%E6%A0%87%E5%87%86%E5%BA%93/" title="Golang-标准库"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/article/202403021705142.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-02</div><div class="title">Golang-标准库</div></div></a></div><div><a href="/2024/03/01/Golang-%E5%9F%BA%E7%A1%80/" title="Golang-基础"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/article/202403021705142.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-01</div><div class="title">Golang-基础</div></div></a></div><div><a href="/2024/03/06/Gorm-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="Gorm（一）快速入门"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-06</div><div class="title">Gorm（一）快速入门</div></div></a></div><div><a href="/2024/03/06/Gorm-%E4%BA%8B%E5%8A%A1%E5%92%8CHook/" title="Gorm（三）事务和Hook"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-06</div><div class="title">Gorm（三）事务和Hook</div></div></a></div><div><a href="/2024/03/06/Gorm-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" title="Gorm（二）增删改查"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-06</div><div class="title">Gorm（二）增删改查</div></div></a></div><div><a href="/2024/03/06/Gorm-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/" title="Gorm（四）高级查询"><img class="cover" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-03-06</div><div class="title">Gorm（四）高级查询</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/album/202308262203639.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.2;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);"><b style="color:#fff">只要我一直还在学习，我就能一直理解自己的痛苦，一直与自己的无知、狭隘、偏见、见招拆招.</b></div> <div style="line-height:1.2;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);"><b style="color:#fff">很多人说要与自己握手言和，但我不要做那样的人，我要拿着石头狠狠打磨我这块石头，一直学习，一直痛苦，一直享受从痛苦的火花里生出的快乐。乘兴而来，直到尽兴而归！</b></div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">戈亓</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/steGeqi" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/674036104?spm_id_from=333.1007.0.0" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><span class="toc-number">1.</span> <span class="toc-text">一、快速入门</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">2.</span> <span class="toc-text">二、路由</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-RESTful-API%E8%A7%84%E8%8C%83"><span class="toc-number">2.1.</span> <span class="toc-text">1. RESTful API规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text">2. 请求方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-URI"><span class="toc-number">2.3.</span> <span class="toc-text">3. URI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="toc-number">2.4.</span> <span class="toc-text">4. 处理函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%88%86%E7%BB%84%E8%B7%AF%E7%94%B1"><span class="toc-number">2.5.</span> <span class="toc-text">5. 分组路由</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">三、请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Get%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text">1. Get请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%99%AE%E9%80%9A%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.1 普通参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%95%B0%E7%BB%84%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.2.</span> <span class="toc-text">1.2 数组参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-map%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.3.</span> <span class="toc-text">1.3 map参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Post%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text">2. Post请求参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E8%A1%A8%E5%8D%95%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text">2.1 表单参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-json%E5%8F%82%E6%95%B0"><span class="toc-number">3.2.2.</span> <span class="toc-text">2.2 json参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text">3. 路径参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%96%87%E4%BB%B6%E5%8F%82%E6%95%B0"><span class="toc-number">3.4.</span> <span class="toc-text">4. 文件参数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%93%8D%E5%BA%94"><span class="toc-number">4.</span> <span class="toc-text">四、响应</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.</span> <span class="toc-text">1. 字符串方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-JSON%E6%96%B9%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">2. JSON方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-XML%E6%96%B9%E5%BC%8F"><span class="toc-number">4.3.</span> <span class="toc-text">3. XML方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.4.</span> <span class="toc-text">4. 文件格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AEhttp%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">4.5.</span> <span class="toc-text">5. 设置http响应头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">4.6.</span> <span class="toc-text">6. 重定向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-YAML%E6%96%B9%E5%BC%8F"><span class="toc-number">4.7.</span> <span class="toc-text">7. YAML方式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93"><span class="toc-number">5.</span> <span class="toc-text">五、模板渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">5.1.</span> <span class="toc-text">1. 基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%A4%9A%E4%B8%AA%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93"><span class="toc-number">5.2.</span> <span class="toc-text">2. 多个模板渲染</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0"><span class="toc-number">5.3.</span> <span class="toc-text">3. 自定义模板函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">5.4.</span> <span class="toc-text">4. 静态文件处理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E4%BC%9A%E8%AF%9D"><span class="toc-number">6.</span> <span class="toc-text">六、会话</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-cookie"><span class="toc-number">6.1.</span> <span class="toc-text">1. cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AE%BE%E7%BD%AEcookie"><span class="toc-number">6.1.1.</span> <span class="toc-text">1.1 设置cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%AF%BB%E5%8F%96cookie"><span class="toc-number">6.1.2.</span> <span class="toc-text">1.2 读取cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%88%A0%E9%99%A4cookie"><span class="toc-number">6.1.3.</span> <span class="toc-text">1.3 删除cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Session"><span class="toc-number">6.2.</span> <span class="toc-text">2. Session</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%A4%9Asession"><span class="toc-number">6.2.1.</span> <span class="toc-text">2.1 多session</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%9F%BA%E4%BA%8Eredis%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%9A%84session"><span class="toc-number">6.2.2.</span> <span class="toc-text">2.2 基于redis存储引擎的session</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">7.</span> <span class="toc-text">七、中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%BD%BF%E7%94%A8"><span class="toc-number">7.1.</span> <span class="toc-text">1. 中间件使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text">2. 自定义中间件</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/07/Docker%EF%BC%88%E4%BA%8C%EF%BC%89Docker%E9%83%A8%E7%BD%B2/" title="Docker（二）Docker部署"><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/docker/202403060010535.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker（二）Docker部署"/></a><div class="content"><a class="title" href="/2024/03/07/Docker%EF%BC%88%E4%BA%8C%EF%BC%89Docker%E9%83%A8%E7%BD%B2/" title="Docker（二）Docker部署">Docker（二）Docker部署</a><time datetime="2024-03-07T10:02:43.000Z" title="发表于 2024-03-07 18:02:43">2024-03-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/06/Gorm-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/" title="Gorm（四）高级查询"><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gorm（四）高级查询"/></a><div class="content"><a class="title" href="/2024/03/06/Gorm-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/" title="Gorm（四）高级查询">Gorm（四）高级查询</a><time datetime="2024-03-05T16:48:55.000Z" title="发表于 2024-03-06 00:48:55">2024-03-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/06/Gorm-%E4%BA%8B%E5%8A%A1%E5%92%8CHook/" title="Gorm（三）事务和Hook"><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gorm（三）事务和Hook"/></a><div class="content"><a class="title" href="/2024/03/06/Gorm-%E4%BA%8B%E5%8A%A1%E5%92%8CHook/" title="Gorm（三）事务和Hook">Gorm（三）事务和Hook</a><time datetime="2024-03-05T16:48:45.000Z" title="发表于 2024-03-06 00:48:45">2024-03-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/06/Gorm-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" title="Gorm（二）增删改查"><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gorm（二）增删改查"/></a><div class="content"><a class="title" href="/2024/03/06/Gorm-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" title="Gorm（二）增删改查">Gorm（二）增删改查</a><time datetime="2024-03-05T16:48:15.000Z" title="发表于 2024-03-06 00:48:15">2024-03-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/06/Gorm-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="Gorm（一）快速入门"><img src="https://geqi-blog.oss-cn-beijing.aliyuncs.com/golang/202403060041431.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Gorm（一）快速入门"/></a><div class="content"><a class="title" href="/2024/03/06/Gorm-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="Gorm（一）快速入门">Gorm（一）快速入门</a><time datetime="2024-03-05T16:41:51.000Z" title="发表于 2024-03-06 00:41:51">2024-03-06</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">16</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://steGeqi.github.io" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于我</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 一些时刻</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Docker/" style="font-size: 0.88rem;">Docker<sup>2</sup></a><a href="/tags/Golang/" style="font-size: 0.88rem;">Golang<sup>7</sup></a><a href="/tags/Gorm/" style="font-size: 0.88rem;">Gorm<sup>4</sup></a><a href="/tags/Leetcode/" style="font-size: 0.88rem;">Leetcode<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>2</sup></a><a href="/tags/Nginx/" style="font-size: 0.88rem;">Nginx<sup>1</sup></a><a href="/tags/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/" style="font-size: 0.88rem;">代码随想录<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>3</sup></a><a href="/tags/%E5%A4%A7%E5%AD%A6/" style="font-size: 0.88rem;">大学<sup>1</sup></a><a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%95%99%E7%A8%8B/" style="font-size: 0.88rem;">小程序教程<sup>1</sup></a><a href="/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" style="font-size: 0.88rem;">年终总结<sup>1</sup></a><a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 0.88rem;">开发<sup>1</sup></a><a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 0.88rem;">微信小程序<sup>1</sup></a><a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 0.88rem;">感悟<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%94%9F%E7%89%A9%E4%BF%A1%E6%81%AF%E5%AD%A6/" style="font-size: 0.88rem;">生物信息学<sup>14</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" style="font-size: 0.88rem;">计算机组成原理<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">计算机网络<sup>6</sup></a><a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 0.88rem;">运维<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/21/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 戈亓 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'default' : 'light'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.cbd.int/mermaid@10.2.4/dist/mermaid.min.js').then(runMermaid)
  }

  anzhiyu.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async src="https://at.alicdn.com/t/c/font_4451085_8zjuxl67yih.js?spm=a313x.manage_type_myprojects.i1.10.530b3a811nEn8T&amp;file=font_4451085_8zjuxl67yih.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>